package org.qin.com.stock;

import com.google.common.collect.Lists;
import lombok.extern.slf4j.Slf4j;
import org.junit.jupiter.api.Test;
import org.qin.com.stock.entity.StockBlockRtInfo;
import org.qin.com.stock.utils.IdWorker;
import org.qin.com.stock.utils.ParserStockInfoUtil;
import org.qin.com.stock.utils.TimeUtil;
import org.springframework.util.CollectionUtils;

import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * @Title: NormalTest
 * @Author Qin
 * @Package org.qin.com.stock
 * @Version
 * @Date 2025/2/8 13:38
 * @description:
 */
@Slf4j
public class NormalTest {
    @Test
    public void test() {
        String data = "var S_Finance_bankuai_sinaindustry =\n" +
                "{\"new_blhy\":\"new_blhy,玻璃行业,19,10.310526315789,0.18263157894737,1.8032531310087,402342432,3608266976,sz300093,7.143,12.900,0.860,金刚光伏\",\"new_cbzz\":\"new_cbzz,船舶制造,8,12.52375,0.03,0.24012006003002,323516417,3154944890,sz300123,1.571,5.820,0.090,亚光科技\",\"new_cmyl\":\"new_cmyl,传媒娱乐,40,8.435,0.10916666666667,1.3111800620559,2006047774,17471464182,sh601929,10.112,1.960,0.180,吉视传媒\",\"new_dlhy\":\"new_dlhy,电力行业,62,6.8101666666667,0.049333333333333,0.72969308517195,1910158259,12800895393,sz000722,3.888,9.620,0.360,湖南发展\",\"new_dqhy\":\"new_dqhy,电器行业,58,13.443888888889,0.16407407407407,1.2355147745813,2055083087,26229771409,sz002647,5.075,5.590,0.270,*ST仁东\",\"new_dzqj\":\"new_dzqj,电子器件,152,18.707876712329,0.19335616438356,1.0443487525526,9510324205,135488016107,sz000536,10.112,4.900,0.450,华映科技\",\"new_dzxx\":\"new_dzxx,电子信息,247,16.091696428571,0.38714285714286,2.4651630839554,19536866504,300968125428,sz300253,16.186,9.260,1.290,卫宁健康\",\"new_fdc\":\"new_fdc,房地产,123,6.1954455445545,0.10435643564356,1.7132639791938,5734913467,26243110484,sh600732,9.966,13.020,1.180,爱旭股份\",\"new_fdsb\":\"new_fdsb,发电设备,65,10.608474576271,0.24169491525424,2.3314367928847,2695319573,29866537320,sh603618,10.052,6.350,0.580,杭电股份\",\"new_fjzz\":\"new_fjzz,飞机制造,14,20.069285714286,0.063571428571429,0.31776635247072,262844305,4736344457,sz000901,2.020,11.110,0.220,航天科技\",\"new_fzhy\":\"new_fzhy,纺织行业,42,6.606,0.12542857142857,1.935455427211,918123125,9497299036,sz000779,10.024,9.110,0.830,甘咨询\",\"new_fzjx\":\"new_fzjx,纺织机械,8,9.1157142857143,0.1,1.1091744572968,216700127,1578788601,sz002021,4.490,2.560,0.110,中捷资源\",\"new_fzxl\":\"new_fzxl,服装鞋类,49,8.0075555555556,0.17822222222222,2.2763396911898,1706599170,9769883439,sz002634,10.059,3.720,0.340,棒杰股份\",\"new_glql\":\"new_glql,公路桥梁,20,7.1461111111111,0.034444444444444,0.48433716115928,305486277,1822954002,sh600106,3.915,5.840,0.220,重庆路桥\",\"new_gsgq\":\"new_gsgq,供水供气,25,6.4416,0.0352,0.54945054945055,378178315,1910072822,sh600333,1.720,4.730,0.080,长春燃气\",\"new_gthy\":\"new_gthy,钢铁行业,60,6.0477777777778,0.11703703703704,1.9733966152501,2711464804,11242290188,sh600126,10.016,6.920,0.630,杭钢股份\",\"new_hbhy\":\"new_hbhy,环保行业,27,5.5132,0.0524,0.95956636390272,734900325,3659814238,sz300197,4.225,2.220,0.090,节能铁汉\",\"new_hghy\":\"new_hghy,化工行业,150,10.447083333333,0.13416666666667,1.3009575370692,4300225214,38762402001,sh600481,10.035,6.250,0.570,双良节能\",\"new_hqhy\":\"new_hqhy,化纤行业,26,6.5575,0.10041666666667,1.5551397044589,808426667,5487257020,sz000584,5.179,2.640,0.130,*ST工智\",\"new_jdhy\":\"new_jdhy,家电行业,37,15.126875,0.1759375,1.1767656710491,2791703112,26638667275,sh600839,10.042,10.520,0.960,四川长虹\",\"new_jdly\":\"new_jdly,酒店旅游,35,12.9684375,0.0475,0.36762038358285,660411559,6997434373,sz002306,10.177,2.490,0.230,中科云网\",\"new_jjhy\":\"new_jjhy,家具行业,16,8.2114285714286,-0.066428571428571,-0.80248511519544,231131303,1450687813,sh600337,3.615,1.720,0.060,美克家居\",\"new_jrhy\":\"new_jrhy,金融行业,51,12.632857142857,0.16408163265306,1.3159402261977,4948963188,47316411531,sh600109,5.875,8.830,0.490,国金证券\",\"new_jtys\":\"new_jtys,交通运输,87,7.6865789473684,0.064210526315789,0.84239599516658,3368984432,19844937683,sz000520,10.110,5.010,0.460,凤凰航运\",\"new_jxhy\":\"new_jxhy,机械行业,211,11.916446700508,0.15751269035533,1.3395150463413,10140291826,100107073632,sz300159,15.640,2.440,0.330,新研股份\",\"new_jzjc\":\"new_jzjc,建筑建材,91,6.2521428571429,0.095714285714286,1.5547047221255,3617957328,19360306280,sz002163,10.049,8.980,0.820,海南发展\",\"new_kfq\":\"new_kfq,开发区,10,16.022,0.37,2.3639151546128,207594460,3849735100,sz000628,4.861,58.240,2.700,高新发展\",\"new_ljhy\":\"new_ljhy,酿酒行业,33,81.4240625,1.183125,1.4744655743834,300158865,16067101328,sh600779,2.717,47.250,1.250,水井坊\",\"new_mtc\":\"new_mtc,摩托车,6,14.198333333333,0.13333333333333,0.9479796184382,272334194,4255532350,sh601777,5.390,7.430,0.380,力帆科技\",\"new_mthy\":\"new_mthy,煤炭行业,41,9.1230769230769,0.17923076923077,2.0039563085921,2386735681,13980700319,sz000034,10.014,39.880,3.630,神州数码\",\"new_nlmy\":\"new_nlmy,农林牧渔,64,8.4535593220339,0.074915254237288,0.89412145486912,1567910702,12061008889,sh600438,7.875,22.740,1.660,通威股份\",\"new_nyhf\":\"new_nyhf,农药化肥,46,9.3344186046512,0.071395348837209,0.77075644598428,893713716,6377445917,sz300261,4.806,6.760,0.310,雅本化学\",\"new_qczz\":\"new_qczz,汽车制造,103,18.466288659794,0.34185567010309,1.8861592541821,5222213373,80851582347,sz002213,9.988,18.170,1.650,大为股份\",\"new_qtxy\":\"new_qtxy,其它行业,202,8.2670601503759,0.065481203007519,0.79839752110817,2038589802,27601058804,sh603300,10.033,6.580,0.600,海南华铁\",\"new_slzp\":\"new_slzp,塑料制品,33,7.8024137931034,0.12379310344828,1.6121789114424,922478224,6815299422,sz300198,4.569,2.060,0.090,纳川股份\",\"new_snhy\":\"new_snhy,水泥行业,26,8.1025,0.12125,1.5191855912294,517316056,2832150015,sh600881,4.651,1.800,0.080,亚泰集团\",\"new_sphy\":\"new_sphy,食品行业,58,10.524259259259,0.1637037037037,1.5800668489821,1770495698,13763018312,sh600186,9.966,6.510,0.590,莲花控股\",\"new_stock\":\"new_stock,次新股,96,54.846666666667,0.86302083333333,1.5986708937699,650632361,23096356975,sz301551,19.487,61.990,10.110,无线传媒\",\"new_swzz\":\"new_swzz,生物制药,155,15.462837837838,0.13331081081081,0.86963420708137,3262856155,31138689167,sh600666,10.088,2.510,0.230,奥瑞德\",\"new_sybh\":\"new_sybh,商业百货,93,8.9768235294118,0.11752941176471,1.3266227557633,3781384129,21669451596,sh600785,9.981,11.680,1.060,新华百货\",\"new_syhy\":\"new_syhy,石油行业,24,6.3217391304348,0.064347826086957,1.0283490828238,839910479,4192395436,sz002629,10.115,4.790,0.440,仁智股份\",\"new_tchy\":\"new_tchy,陶瓷行业,8,12.66,-0.11,-0.86139389193422,96934343,824677232,sz002102,2.075,2.460,0.050,能特科技\",\"new_wzwm\":\"new_wzwm,物资外贸,21,8.697,0.104,1.2102874432678,1055671128,7164791106,sh600120,10.065,6.780,0.620,浙江东方\",\"new_ylqx\":\"new_ylqx,医疗器械,31,15.282962962963,0.36296296296296,2.4327276338,555889616,7758876546,sz300244,9.444,12.400,1.070,迪安诊断\",\"new_yqyb\":\"new_yqyb,仪器仪表,48,14.338125,0.086666666666667,0.60812489949859,1749425174,23810832852,sz300338,10.198,3.890,0.360,*ST开元\",\"new_ysbz\":\"new_ysbz,印刷包装,20,6.8677777777778,0.10777777777778,1.5943458251151,1401283357,11382250998,sz300057,19.957,5.590,0.930,万顺新材\",\"new_ysjs\":\"new_ysjs,有色金属,72,11.900923076923,0.094769230769231,0.80271045087308,3722746984,33836555724,sh600673,6.605,11.460,0.710,东阳光\",\"new_zhhy\":\"new_zhhy,综合行业,33,5.3669230769231,0.089230769230769,1.6907156391197,1006703457,3770505187,sh600603,4.962,9.730,0.460,ST广物\",\"new_zzhy\":\"new_zzhy,造纸行业,24,6.1273913043478,0.083913043478261,1.3884892086331,930805816,4650700739,sz000820,4.983,3.160,0.150,神雾节能\"}";
        // 正则表达式匹配键值对
        Pattern pattern = Pattern.compile("\"([^\"]+)\":\"([^\"]+)\"");
        Matcher matcher = pattern.matcher(data);

        Date curTime = new TimeUtil().nowWithoutSec();
        log.info(curTime.toString());

        // 存储解析结果
        Map<String, String[]> parsedData = new HashMap<>();
        if(matcher.find()){
            log.info(matcher.group(1));
            log.info(matcher.group(2));
        }
    }
    @Test
    public void test02() {
        String data = "var S_Finance_bankuai_sinaindustry =\n" +
                "{\"new_blhy\":\"new_blhy,玻璃行业,19,10.310526315789,0.18263157894737,1.8032531310087,402342432,3608266976,sz300093,7.143,12.900,0.860,金刚光伏\",\"new_cbzz\":\"new_cbzz,船舶制造,8,12.52375,0.03,0.24012006003002,323516417,3154944890,sz300123,1.571,5.820,0.090,亚光科技\",\"new_cmyl\":\"new_cmyl,传媒娱乐,40,8.435,0.10916666666667,1.3111800620559,2006047774,17471464182,sh601929,10.112,1.960,0.180,吉视传媒\",\"new_dlhy\":\"new_dlhy,电力行业,62,6.8101666666667,0.049333333333333,0.72969308517195,1910158259,12800895393,sz000722,3.888,9.620,0.360,湖南发展\",\"new_dqhy\":\"new_dqhy,电器行业,58,13.443888888889,0.16407407407407,1.2355147745813,2055083087,26229771409,sz002647,5.075,5.590,0.270,*ST仁东\",\"new_dzqj\":\"new_dzqj,电子器件,152,18.707876712329,0.19335616438356,1.0443487525526,9510324205,135488016107,sz000536,10.112,4.900,0.450,华映科技\",\"new_dzxx\":\"new_dzxx,电子信息,247,16.091696428571,0.38714285714286,2.4651630839554,19536866504,300968125428,sz300253,16.186,9.260,1.290,卫宁健康\",\"new_fdc\":\"new_fdc,房地产,123,6.1954455445545,0.10435643564356,1.7132639791938,5734913467,26243110484,sh600732,9.966,13.020,1.180,爱旭股份\",\"new_fdsb\":\"new_fdsb,发电设备,65,10.608474576271,0.24169491525424,2.3314367928847,2695319573,29866537320,sh603618,10.052,6.350,0.580,杭电股份\",\"new_fjzz\":\"new_fjzz,飞机制造,14,20.069285714286,0.063571428571429,0.31776635247072,262844305,4736344457,sz000901,2.020,11.110,0.220,航天科技\",\"new_fzhy\":\"new_fzhy,纺织行业,42,6.606,0.12542857142857,1.935455427211,918123125,9497299036,sz000779,10.024,9.110,0.830,甘咨询\",\"new_fzjx\":\"new_fzjx,纺织机械,8,9.1157142857143,0.1,1.1091744572968,216700127,1578788601,sz002021,4.490,2.560,0.110,中捷资源\",\"new_fzxl\":\"new_fzxl,服装鞋类,49,8.0075555555556,0.17822222222222,2.2763396911898,1706599170,9769883439,sz002634,10.059,3.720,0.340,棒杰股份\",\"new_glql\":\"new_glql,公路桥梁,20,7.1461111111111,0.034444444444444,0.48433716115928,305486277,1822954002,sh600106,3.915,5.840,0.220,重庆路桥\",\"new_gsgq\":\"new_gsgq,供水供气,25,6.4416,0.0352,0.54945054945055,378178315,1910072822,sh600333,1.720,4.730,0.080,长春燃气\",\"new_gthy\":\"new_gthy,钢铁行业,60,6.0477777777778,0.11703703703704,1.9733966152501,2711464804,11242290188,sh600126,10.016,6.920,0.630,杭钢股份\",\"new_hbhy\":\"new_hbhy,环保行业,27,5.5132,0.0524,0.95956636390272,734900325,3659814238,sz300197,4.225,2.220,0.090,节能铁汉\",\"new_hghy\":\"new_hghy,化工行业,150,10.447083333333,0.13416666666667,1.3009575370692,4300225214,38762402001,sh600481,10.035,6.250,0.570,双良节能\",\"new_hqhy\":\"new_hqhy,化纤行业,26,6.5575,0.10041666666667,1.5551397044589,808426667,5487257020,sz000584,5.179,2.640,0.130,*ST工智\",\"new_jdhy\":\"new_jdhy,家电行业,37,15.126875,0.1759375,1.1767656710491,2791703112,26638667275,sh600839,10.042,10.520,0.960,四川长虹\",\"new_jdly\":\"new_jdly,酒店旅游,35,12.9684375,0.0475,0.36762038358285,660411559,6997434373,sz002306,10.177,2.490,0.230,中科云网\",\"new_jjhy\":\"new_jjhy,家具行业,16,8.2114285714286,-0.066428571428571,-0.80248511519544,231131303,1450687813,sh600337,3.615,1.720,0.060,美克家居\",\"new_jrhy\":\"new_jrhy,金融行业,51,12.632857142857,0.16408163265306,1.3159402261977,4948963188,47316411531,sh600109,5.875,8.830,0.490,国金证券\",\"new_jtys\":\"new_jtys,交通运输,87,7.6865789473684,0.064210526315789,0.84239599516658,3368984432,19844937683,sz000520,10.110,5.010,0.460,凤凰航运\",\"new_jxhy\":\"new_jxhy,机械行业,211,11.916446700508,0.15751269035533,1.3395150463413,10140291826,100107073632,sz300159,15.640,2.440,0.330,新研股份\",\"new_jzjc\":\"new_jzjc,建筑建材,91,6.2521428571429,0.095714285714286,1.5547047221255,3617957328,19360306280,sz002163,10.049,8.980,0.820,海南发展\",\"new_kfq\":\"new_kfq,开发区,10,16.022,0.37,2.3639151546128,207594460,3849735100,sz000628,4.861,58.240,2.700,高新发展\",\"new_ljhy\":\"new_ljhy,酿酒行业,33,81.4240625,1.183125,1.4744655743834,300158865,16067101328,sh600779,2.717,47.250,1.250,水井坊\",\"new_mtc\":\"new_mtc,摩托车,6,14.198333333333,0.13333333333333,0.9479796184382,272334194,4255532350,sh601777,5.390,7.430,0.380,力帆科技\",\"new_mthy\":\"new_mthy,煤炭行业,41,9.1230769230769,0.17923076923077,2.0039563085921,2386735681,13980700319,sz000034,10.014,39.880,3.630,神州数码\",\"new_nlmy\":\"new_nlmy,农林牧渔,64,8.4535593220339,0.074915254237288,0.89412145486912,1567910702,12061008889,sh600438,7.875,22.740,1.660,通威股份\",\"new_nyhf\":\"new_nyhf,农药化肥,46,9.3344186046512,0.071395348837209,0.77075644598428,893713716,6377445917,sz300261,4.806,6.760,0.310,雅本化学\",\"new_qczz\":\"new_qczz,汽车制造,103,18.466288659794,0.34185567010309,1.8861592541821,5222213373,80851582347,sz002213,9.988,18.170,1.650,大为股份\",\"new_qtxy\":\"new_qtxy,其它行业,202,8.2670601503759,0.065481203007519,0.79839752110817,2038589802,27601058804,sh603300,10.033,6.580,0.600,海南华铁\",\"new_slzp\":\"new_slzp,塑料制品,33,7.8024137931034,0.12379310344828,1.6121789114424,922478224,6815299422,sz300198,4.569,2.060,0.090,纳川股份\",\"new_snhy\":\"new_snhy,水泥行业,26,8.1025,0.12125,1.5191855912294,517316056,2832150015,sh600881,4.651,1.800,0.080,亚泰集团\",\"new_sphy\":\"new_sphy,食品行业,58,10.524259259259,0.1637037037037,1.5800668489821,1770495698,13763018312,sh600186,9.966,6.510,0.590,莲花控股\",\"new_stock\":\"new_stock,次新股,96,54.846666666667,0.86302083333333,1.5986708937699,650632361,23096356975,sz301551,19.487,61.990,10.110,无线传媒\",\"new_swzz\":\"new_swzz,生物制药,155,15.462837837838,0.13331081081081,0.86963420708137,3262856155,31138689167,sh600666,10.088,2.510,0.230,奥瑞德\",\"new_sybh\":\"new_sybh,商业百货,93,8.9768235294118,0.11752941176471,1.3266227557633,3781384129,21669451596,sh600785,9.981,11.680,1.060,新华百货\",\"new_syhy\":\"new_syhy,石油行业,24,6.3217391304348,0.064347826086957,1.0283490828238,839910479,4192395436,sz002629,10.115,4.790,0.440,仁智股份\",\"new_tchy\":\"new_tchy,陶瓷行业,8,12.66,-0.11,-0.86139389193422,96934343,824677232,sz002102,2.075,2.460,0.050,能特科技\",\"new_wzwm\":\"new_wzwm,物资外贸,21,8.697,0.104,1.2102874432678,1055671128,7164791106,sh600120,10.065,6.780,0.620,浙江东方\",\"new_ylqx\":\"new_ylqx,医疗器械,31,15.282962962963,0.36296296296296,2.4327276338,555889616,7758876546,sz300244,9.444,12.400,1.070,迪安诊断\",\"new_yqyb\":\"new_yqyb,仪器仪表,48,14.338125,0.086666666666667,0.60812489949859,1749425174,23810832852,sz300338,10.198,3.890,0.360,*ST开元\",\"new_ysbz\":\"new_ysbz,印刷包装,20,6.8677777777778,0.10777777777778,1.5943458251151,1401283357,11382250998,sz300057,19.957,5.590,0.930,万顺新材\",\"new_ysjs\":\"new_ysjs,有色金属,72,11.900923076923,0.094769230769231,0.80271045087308,3722746984,33836555724,sh600673,6.605,11.460,0.710,东阳光\",\"new_zhhy\":\"new_zhhy,综合行业,33,5.3669230769231,0.089230769230769,1.6907156391197,1006703457,3770505187,sh600603,4.962,9.730,0.460,ST广物\",\"new_zzhy\":\"new_zzhy,造纸行业,24,6.1273913043478,0.083913043478261,1.3884892086331,930805816,4650700739,sz000820,4.983,3.160,0.150,神雾节能\"}";
        List<StockBlockRtInfo> list;
        list = new ParserStockInfoUtil(new IdWorker()).parse4StockBlock(data);
        if(!CollectionUtils.isEmpty(list)){
            for (StockBlockRtInfo stockBlockRtInfo : list) {
                log.info(stockBlockRtInfo.getBlockName());
            }
        }
//        // 正则表达式匹配键值对
//        Pattern pattern = Pattern.compile("\"([^\"]+)\":\"([^\"]+)\"");
//        Matcher matcher = pattern.matcher(data);
//
//        Date curTime = new TimeUtil().nowWithoutSec();
//        log.info(curTime.toString());
//
//        // 存储解析结果
//        Map<String, String[]> parsedData = new HashMap<>();
//        if(matcher.find()){
//            log.info(matcher.group(1));
//            log.info(matcher.group(2));
//        }
    }
    @Test
    public void testPartion() {
        List<Integer> all=new ArrayList<>();
        for (int i = 1; i <= 50; i++) {
            all.add(i);
        }
        //将集合均等分，每份大小最多15个
        Lists.partition(all,15).forEach(ids->{
            System.out.println(ids);
        });
    }
}
